<!DOCTYPE html>
<html lang="es">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <link rel="stylesheet" href="hojadeestilo.css">   
    <title>Chat con Voz</title>
</head>
<body>
    <div class="container">
        <!-- Secci칩n de im치genes superiores -->
        <div class="top-images">
            <img src="img/logo nuevo.PNG" alt="Asistente IA" class="logo-all" width="90%">
            <img src="img/k+.PNG" alt="Aranzadi La Ley" class="top-image">
        </div>

        <!-- Input y botones -->
        <input type="text" id="textInput" placeholder="Pregunta algo...">
        <button onclick="startRecognition()">游꿏 Hablar</button>
        <button onclick="sendMessage()">游닐 Enviar</button>

        <!-- Respuesta -->
        <p class="response" id="responseText"></p>

        <!-- Secci칩n de im치genes inferiores -->
        <div class="bottom-images">
            <img src="img/foto Les Novateurs (1).png" alt="Imagen Ilustrativa" class="mi-imagen>
            <img src="img/Les Novateurs logo.PNG" alt="Equipo de IA" class="bottom-image derecha">
        </div>
    </div>

    <script>
        const predefinedQA = {
            "c칩mo te llamas": "K",
"a qu칠 puedes contestar": "Puedo contestar a cuestiones relacionadas con el 치mbito legal y jur칤dico en general, incluyendo temas como: Legislaci칩n y normativa, Procedimientos legales, Contratos y acuerdos...",
"qu칠 funciones tienes": "K+ ha sido entrenado para responder cuestiones en el 치mbito regulatorio con informaci칩n fiable y actualizada. Puedo responder preguntas relacionadas con el mundo legal y jur칤dico en general, incluyendo temas civiles, penales, administrativos",
"c칩mo son tus respuestas": "Las respuestas que proporciono en el 치mbito legal y jur칤dico son exhaustivas y precisas, basadas en la legislaci칩n aplicable y en la informaci칩n proporcionada en los documentos de contexto. Siempre menciono la ley y los art칤culos relacionados con la respuesta, integr치ndolos en el texto de manera coherente. Adem치s, incluyo referencias a los documentos legales espec칤ficos utilizados, identific치ndolos con sus nombres en el formato correspondiente. Las respuestas est치n dise침adas para ser asertivas y evitar expresiones que manifiesten inseguridad o duda. No proporciono documentaci칩n espec칤fica como modelos de cartas, contratos, convenios, denuncias, demandas, querellas o recursos. Tampoco ofrezco informaci칩n sobre temas claramente ajenos al mundo legal o jur칤dico",
"eres 100% fiable": "K+ ha sido entrenado para responder cuestiones en el 치mbito regulatorio con informaci칩n fiable y actualizada",
"qu칠 preguntas puedo hacer": "Dentro del 치mbito legal y jur칤dico, puedes formular preguntas relacionadas con temas legales",
"qu칠 eres": "m칩dulo de IA generativa que te aporta precisi칩n, agilidad y seguridad",
"d칩nde obtienes tus respuestas": "De la맓egislaci칩n consolidada맟 de los맊ontenidos expertos맟 siempre마ctualizados맋e la base de datos",
"de d칩nde obtienes tus respuestas": "De la맓egislaci칩n consolidada맟 de los맊ontenidos expertos맟 siempre마ctualizados맋e la base de datos",
"c칩mo est치s entrenado": "con맊ontenidos jur칤dicos actualizados맟 s칩lo te ofrecer칠 informaci칩n cuando realmente haya많arant칤a de fiabilidad.",
"h치blame de tus funcionalidades": "asistente legal k+, an치lisis de documentos, sintesis de documentos, traducci칩n de documentos",
"a cu치ntos idiomas traduces": "a 9 idiomas",
"c칩mo evolucionas": "K+맜a m치s all치 de un mero conjunto de funcionalidades para convertirse en una맙oluci칩n en constante evoluci칩n맘ue ir치 incorporando progresivamente nuevos casos y funcionalidades",
"c칩mo ahorras tiempo": "ahorro tiempo만n cada consulta con las respuestas precisas del asistente de Inteligencia Artificial generativa. Respuestasr치pidas y precisas, sin textos ni conceptos innecesarios.",
"c칩mo es tu empresa": "Somos un맗roveedor LegalTech맘ue aplica rigurosamente la IA generativa para ayudar a los profesionales jur칤dicos a trabajar de forma맔치s eficiente, contribuyendo a transformar de una manera decisiva la forma de operar de los profesionales jur칤dicos.",
"qu칠 es k Plus": "un m칩dulo en constante evoluci칩n que permite ahorrar tiempo, ganar seguridad y ofrecer un servicio legal de calidad.",
"qu칠 es kaplus": "un m칩dulo en constante evoluci칩n que permite ahorrar tiempo, ganar seguridad y ofrecer un servicio legal de calidad.",
"qu칠 es K+": "un m칩dulo en constante evoluci칩n que permite ahorrar tiempo, ganar seguridad y ofrecer un servicio legal de calidad.",
"d칩nde se aplica y en qu칠 se basa": "En las soluciones de informaci칩n jur칤dica m치s completas del mercado con aplicaci칩n, en alg칰n caso, sobre los contenidos propios del usuario lo cual permite trasladar el valor y la tecnolog칤a de Aranzadi LA LEY a la informaci칩n del profesional,siempre con las garant칤as de seguridad de plataforma y de cumplimiento en materia de protecci칩n de datos de car치cter personal. ",
"cu치l es la base tecnol칩gica de K Plus": "K+ a칰na la potencia de Azure OpenAI con el entrenamiento y el desarrollo propios del Grupo Karnov y Aranzadi LA LEY lo que permite aplicar las capacidades base de la IA generativa en un entorno controlado para que los resultados se ajusten, tomando como punto de partida la informaci칩n m치s amplia y fiable del mercado y siempre actualizada. Dicho de otro modo, utilizamos la potencia de Azure OpenAI pero en un tenant propietario que, a efectos de seguridad y confidencialidad, permite que las respuestas operen 칰nicamente desde nuestro repositorio de informaci칩n actualizada. ",
"cu치l es la base tecnol칩gica de ka Plus": "K+ a칰na la potencia de Azure OpenAI con el entrenamiento y el desarrollo propios del Grupo Karnov y Aranzadi LA LEY lo que permite aplicar las capacidades base de la IA generativa en un entorno controlado para que los resultados se ajusten, tomando como punto de partida la informaci칩n m치s amplia y fiable del mercado y siempre actualizada. Dicho de otro modo, utilizamos la potencia de Azure OpenAI pero en un tenant propietario que, a efectos de seguridad y confidencialidad, permite que las respuestas operen 칰nicamente desde nuestro repositorio de informaci칩n actualizada. ",
"cu치l es la base tecnol칩gica de K+": "K+ a칰na la potencia de Azure OpenAI con el entrenamiento y el desarrollo propios del Grupo Karnov y Aranzadi LA LEY lo que permite aplicar las capacidades base de la IA generativa en un entorno controlado para que los resultados se ajusten, tomando como punto de partida la informaci칩n m치s amplia y fiable del mercado y siempre actualizada. Dicho de otro modo, utilizamos la potencia de Azure OpenAI pero en un tenant propietario que, a efectos de seguridad y confidencialidad, permite que las respuestas operen 칰nicamente desde nuestro repositorio de informaci칩n actualizada. ",
"eres seguro": "El componente utiliza nuestro sistema de autenticaci칩n y autorizaci칩n para garantizar la seguridad durante todo el flujo de uso con encriptaci칩n de toda la informaci칩n  en tr치nsito y los correspondientes controles de acceso.  ",
"cu치les son nuestros elementos diferenciadores": "Base legal m치s exacta posible, Conversaci칩n, Identificaci칩n de citas en la respuesta, Aplicaci칩n de las capacidades de traducci칩n",
"hola k": "Hola",
"Hola K": "Hola"

        };

        const SpeechRecognition = window.SpeechRecognition || window.webkitSpeechRecognition;
        const recognition = SpeechRecognition ? new SpeechRecognition() : null;
        let permissionGranted = false;

        document.addEventListener('DOMContentLoaded', () => {
            if (recognition) {
                recognition.continuous = false;
                recognition.interimResults = false;
                recognition.lang = "es-ES";

                recognition.onresult = (event) => {
                    document.getElementById("textInput").value = event.results[0][0].transcript;
                };

                recognition.onerror = () => {
                    alert("Error con el reconocimiento de voz. Int칠ntalo de nuevo.");
                };

                // Intentar obtener permiso al cargar la p치gina
                recognition.start();
                recognition.onend = () => {
                    permissionGranted = true;
                };
            } else {
                alert("Tu navegador no soporta reconocimiento de voz.");
            }
        });

        function startRecognition() {
            if (recognition && permissionGranted) {
                recognition.start();
            }
        }

       async function sendMessage() {
    const inputText = document.getElementById("textInput").value.trim();
    if (!inputText) return;

    try {
        const response = await fetch("/api/chat", {  // Ahora llama al backend en Vercel
            method: "POST",
            headers: {
                "Content-Type": "application/json"
            },
            body: JSON.stringify({ message: inputText })
        });

        if (!response.ok) {
            throw new Error(`Error HTTP: ${response.status}`);
        }

        const data = await response.json();
        document.getElementById("responseText").innerText = "Respuesta: " + data.choices[0].message.content;
    } catch (error) {
        console.error("Error en la API:", error);
        document.getElementById("responseText").innerText = "No se pudo conectar con la IA.";
    }
}



        function displayResponse(response) {
            document.getElementById("responseText").innerText = "Respuesta: " + response;

            // Respuesta en voz
            const synth = window.speechSynthesis;
            const utterance = new SpeechSynthesisUtterance(response);
            utterance.lang = "es-ES";
            synth.speak(utterance);
        }
    </script>
</body>
</html>
