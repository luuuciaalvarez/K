<!DOCTYPE html>
<html lang="es">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <link rel="stylesheet" href="hojadeestilo.css">   
    <title>Chat con Voz</title>
</head>
<body>
    <div class="container">
        <!-- Secci칩n de im치genes superiores -->
        <div class="top-images">
            <img src="img/logo nuevo.PNG" alt="Asistente IA" class="logo-all" width="90%">
            <img src="img/k+.PNG" alt="Aranzadi La Ley" class="top-image">
        </div>

        <!-- Input y botones -->
        <input type="text" id="textInput" placeholder="Pregunta algo...">
        <button onclick="startRecognition()">游꿏 Hablar</button>
        <button onclick="sendMessage()">游닐 Enviar</button>

        <!-- Respuesta -->
        <p class="response" id="responseText"></p>

        <!-- Secci칩n de im치genes inferiores -->
        <div class="bottom-images">
            <img src="img/foto Les Novateurs (1).png" alt="Imagen Ilustrativa" class="bottom-image">
            <img src="img/Les Novateurs logo.PNG" alt="Equipo de IA" class="bottom-image" width="100%">
        </div>
    </div>

    <script>
        const predefinedQA = {
            "c칩mo te llamas": "K",
            "a qu칠 puedes contestar": "Puedo contestar a cuestiones relacionadas con el 치mbito legal y jur칤dico en general, incluyendo temas como: Legislaci칩n y normativa, Procedimientos legales, Contratos y acuerdos...",
            "qu칠 funciones tienes": "K+ ha sido entrenado para responder cuestiones en el 치mbito regulatorio con informaci칩n fiable y actualizada. Puedo responder preguntas relacionadas con el mundo legal y jur칤dico en general, incluyendo temas civiles, penales, administrativos",
            "c칩mo son tus respuestas": "Las respuestas que proporciono en el 치mbito legal y jur칤dico son exhaustivas y precisas, basadas en la legislaci칩n aplicable y en la informaci칩n proporcionada en los documentos de contexto. Siempre menciono la ley y los art칤culos relacionados con la respuesta, integr치ndolos en el texto de manera coherente. Adem치s, incluyo referencias a los documentos legales espec칤ficos utilizados, identific치ndolos con sus nombres en el formato correspondiente. Las respuestas est치n dise침adas para ser asertivas y evitar expresiones que manifiesten inseguridad o duda. No proporciono documentaci칩n espec칤fica como modelos de cartas, contratos, convenios, denuncias, demandas, querellas o recursos. Tampoco ofrezco informaci칩n sobre temas claramente ajenos al mundo legal o jur칤dico",
            "eres 100% fiable": "K+ ha sido entrenado para responder cuestiones en el 치mbito regulatorio con informaci칩n fiable y actualizada",
            "qu칠 preguntas puedo hacer": "Dentro del 치mbito legal y jur칤dico, puedes formular preguntas relacionadas con temas legales",
            "qu칠 eres": "m칩dulo de IA generativa que te aporta precisi칩n, agilidad y seguridad",
            "d칩nde obtienes tus respuestas": "De la legislaci칩n consolidada y de los contenidos expertos y siempre actualizados de la base de datos",
            "de d칩nde obtienes tus respuestas": "De la legislaci칩n consolidada y de los contenidos expertos y siempre actualizados de la base de datos",
            "c칩mo est치s entrenado": "con contenidos jur칤dicos actualizados y s칩lo te ofrecer칠 informaci칩n cuando realmente haya garant칤a de fiabilidad.",
            "h치blame de tus funcionalidades": "asistente legal k+, an치lisis de documentos, sintesis de documentos, traducci칩n de documentos",
            "a cu치ntos idiomas traduces": "a 9 idiomas",
            "c칩mo evolucionas": "K+ va m치s all치 de un mero conjunto de funcionalidades para convertirse en una soluci칩n en constante evoluci칩n que ir치 incorporando progresivamente nuevos casos y funcionalidades",
            "c칩mo ahorras tiempo": "ahorro tiempo en cada consulta con las respuestas precisas del asistente de Inteligencia Artificial generativa. Respuestas r치pidas y precisas, sin textos ni conceptos innecesarios.",
            "c칩mo es tu empresa": "Somos un proveedor LegalTech que aplica rigurosamente la IA generativa para ayudar a los profesionales jur칤dicos a trabajar de forma m치s eficiente, contribuyendo a transformar de una manera decisiva la forma de operar de los profesionales jur칤dicos.",
            "cu치les son nuestros elementos diferenciadores": "Base legal m치s exacta posible, Conversaci칩n, Identificaci칩n de citas en la respuesta, Aplicaci칩n de las capacidades de traducci칩n",
            "hola k": "Hola",
            "Hola K": "Hola"
        };

        const SpeechRecognition = window.SpeechRecognition || window.webkitSpeechRecognition;
        const recognition = SpeechRecognition ? new SpeechRecognition() : null;
        let permissionGranted = false;

        document.addEventListener('DOMContentLoaded', () => {
            if (recognition) {
                recognition.continuous = false;
                recognition.interimResults = false;
                recognition.lang = "es-ES";

                recognition.onresult = (event) => {
                    document.getElementById("textInput").value = event.results[0][0].transcript;
                };

                recognition.onerror = () => {
                    alert("Error con el reconocimiento de voz. Int칠ntalo de nuevo.");
                };

                // Intentar obtener permiso al cargar la p치gina
                recognition.start();
                recognition.onend = () => {
                    permissionGranted = true;
                };
            } else {
                alert("Tu navegador no soporta reconocimiento de voz.");
            }
        });

        function startRecognition() {
            if (recognition && permissionGranted) {
                recognition.start();
            }
        }

        async function sendMessage() {
            const inputText = document.getElementById("textInput").value.trim();
            if (!inputText) return;

            const predefinedResponse = predefinedQA[inputText.toLowerCase()];
            if (predefinedResponse) {
                displayResponse(predefinedResponse);
                return;
            }

            try {
                const apiKey = "https://github.com/luuuciaalvarez/K/edit/main/docs/index.html#L99C32-L99C196"; // Reemplaza con tu clave real
                const response = await fetch("https://api.openai.com/v1/chat/completions", {
                    method: "POST",
                    headers: {
                        "Content-Type": "application/json",
                        "Authorization": `Bearer https://github.com/luuuciaalvarez/K/edit/main/docs/index.html#L99C32-L99C196`,
                        "OpenAI-Beta": "asistentes=v2"
                    },
                    body: JSON.stringify({
                        model: "gpt-3.5-turbo",
                        messages: [{ role: "user", content: inputText }],
                        max_tokens: 100
                    })
                });

                if (!response.ok) {
                    throw new Error(`Error HTTP: ${response.status}`);
                }

                const data = await response.json();
                displayResponse(data.choices[0].message.content);
            } catch (error) {
                console.error("Error en la API:", error);
                displayResponse("No se pudo conectar con la IA.");
            }
        }

        function displayResponse(response) {
            document.getElementById("responseText").innerText = "Respuesta: " + response;

            // Respuesta en voz
            const synth = window.speechSynthesis;
            const utterance = new SpeechSynthesisUtterance(response);
            utterance.lang = "es-ES";
            synth.speak(utterance);
        }
    </script>
</body>
</html>
